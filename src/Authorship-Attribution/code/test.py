import numpy as np
from sklearn.cluster import DBSCAN
def is_abnormal(arr):
    '''检测arr中是否有异常梯度'''
    arr = np.array([i / arr[0] for i in arr]).reshape(-1,1)     # 将第一个元素设置为1
    dbscan = DBSCAN(eps=0.6, min_samples=3)
    dbscan.fit(arr)

    # 获取每个数据点的类别
    labels = dbscan.labels_

    # 找到labels为-1的索引
    index = np.where(labels == -1)[0]
    print(index)
    return 0 in index

preds = [(51, 0.07475812695920467), (55, 0.12251519784331322), (39, 0.1299282323036875), (7, 0.1354871200663703), (13, 0.14614083617925644), (34, 0.1476414746471814), (59, 0.14884973876178265), (56, 0.15088068507611752), (60, 0.15703956969082355), (18, 0.16163613966533116), (62, 0.1646749321371317), (32, 0.16848776383059366), (23, 0.1685432248881885), (64, 0.17608314286917448), (57, 0.17690926417708397), (36, 0.17708109532083785), (38, 0.178425418479102), (2, 0.17851526822362626), (25, 0.18349755462259054), (53, 0.18557431548833847), (15, 0.18934052543980734), (24, 0.19175378552504949), (22, 0.19939427503517695), (6, 0.20032370516232081), (44, 0.2041166807923998), (49, 0.20737336150237493), (43, 0.20796096750668117), (4, 0.21149797311850957), (42, 0.21798617924962724), (52, 0.22865045256912708), (61, 0.23269158601760864), (5, 0.23340699928147451), (0, 0.23419081739016942), (11, 0.23548375921589987), (12, 0.2370809784957341), (35, 0.23874427378177643), (14, 0.24700354891163961), (45, 0.24722182537828172), (31, 0.25058579657758984), (10, 0.2567076214722225), (28, 0.2653183043003082), (30, 0.26563768301691326), (19, 0.26591700528349194), (8, 0.2701987326145172), (21, 0.2776860126427242), (41, 0.28143616020679474), (50, 0.2816305948155267), (54, 0.2861916869878769), (33, 0.2882512126650129), (37, 0.2900808219398771), (58, 0.29237005673348904), (29, 0.2928644099405834), (63, 0.30392446741461754), (16, 0.3043560768876757), (27, 0.31466379335948397), (26, 0.3312885250364031), (48, 0.3375190922192165), (1, 0.3588780462741852), (47, 0.36373880931309294), (3, 0.4160342961549759), (46, 0.4789572741304125), (20, 0.48239595123699736), (40, 0.5214889219829014), (9, 0.6483068806784493), (17, 0.6943904459476471)]
print(is_abnormal(np.array([i[1] for i in preds])))